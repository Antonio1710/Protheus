//CALCULO DO MODULO 11 PARA DIGITO VERIFICADOR DO HSBC - RAFAEL H SILVEIRA 31/10/2006
USER FUNCTION MOD399()    

U_ADINF009P(SUBSTRING(ALLTRIM(PROCNAME()),3,LEN(ALLTRIM(PROCNAME()))) + '.PRW',SUBSTRING(ALLTRIM(PROCNAME()),3,LEN(ALLTRIM(PROCNAME()))),'CALCULO DO MODULO 11 PARA DIGITO VERIFICADOR DO HSBC')
_CNUM := PARAMIXB
NMIN := 7
NMAX := 2
NLEN := LEN( _CNUM )
NSUM := 0
NMIN := IF( NMIN == NIL, 2, NMIN )
NMAX := IF( NMAX == NIL, 7, NMAX )
NFAT := NMAX
FOR _NI := NLEN TO 1 STEP -1
NSUM += VAL( SUBSTR( _CNUM, _NI, 1 ) ) * NFAT
IF NFAT == NMIN
NFAT := NMAX
ELSE
NFAT ++
END
NEXT
_NI := (NSUM % 11)
IF _NI = 0 .OR. _NI = 1                
	_NI := "0" 
ELSE
_NI := 11-(NSUM % 11)
ENDIF
RETURN(_NI)